---
tags:
  - SnappCTF
  - SnappCTF-2024
  - Crypto  
  - RSA
  - RSA-keygen
---


# Ú†Ø§Ù„Ø´ Bombastic

<center> 
![Bombastic](Bombastic.PNG)
</center>


## Ù†Ú¯Ø§Ù‡ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ù‡ Ø³ÙˆØ§Ù„
Ø¯Ø± Ø§ÛŒÙ† Ø³ÙˆØ§Ù„ Ø§Ø² Ø±Ù…Ø²Ù†Ú¯Ø§Ø±ÛŒ RSA Ø¨Ø±Ø§ÛŒ Ø±Ù…Ø²Ú¯Ø°Ø§Ø±ÛŒ ÙÙ„Ú¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ùˆ Ù…Ø§ Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø·Ø±ÛŒÙ‚ÛŒ Ø¨ØªÙˆÙ†ÛŒÙ… Ù…ØªÙ† Ø±Ù…Ø²Ø´Ø¯Ù‡ Ø±Ùˆ Ø±Ù…Ø²Ú¯Ø´Ø§ÛŒÛŒ Ú©Ù†ÛŒÙ… Ùˆ Ø¨Ù‡ ÙÙ„Ú¯ Ø¨Ø±Ø³ÛŒÙ….

Ø¨ÛŒØ§ÛŒÙ… Ù†Ú¯Ø§Ù‡ÛŒ Ø¨Ù‡ ØªÙˆØ§Ø¨Ø¹ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù¾Ø§ÛŒØªÙˆÙ† Ø³ÙˆØ§Ù„ Ø¨Ù†Ø¯Ø§Ø²ÛŒÙ…
### ØªØ§Ø¨Ø¹ `check`:
Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ ÛŒÚ© Ø¹Ø¯Ø¯ ÙˆØ±ÙˆØ¯ÛŒ Ù…ÛŒÚ¯ÛŒØ±Ù‡ Ùˆ Ø¨Ø±Ø§Ø³Ø§Ø³ ÛŒÚ©Ø³Ø±ÛŒ ÙØ¹Ù„ Ùˆ Ø§Ù†ÙØ¹Ø§Ù„Ø§Øª Ø§Ø² Ø¹Ø¯Ø¯ ÙˆØ±ÙˆØ¯ÛŒØŒ ÛŒÚ© Ù„ÛŒØ³Øª Ø§Ø² Ø§Ø¹Ø¯Ø§Ø¯ Ø§ÙˆÙ„ (Ø¯Ø±ØµÙˆØ±Øª Ø§Ù…Ú©Ø§Ù†) Ø¨Ø±Ù…ÛŒÚ¯Ø±Ø¯ÙˆÙ†Ù‡

```python
def check(n):
    sn = str(n)
    l, P = len(str(n)), []
    for i in range(1, l - 1):
        for j in range(i + 1, l):
            g, e, a = int(sn[:i]), int(sn[i:j]), int(sn[j:])
            if isPrime(g ** e + a):
                P.append(g ** e + a)
            if isPrime(g** e - a):
                P.append(g ** e - a)
    return P
```

### ØªØ§Ø¨Ø¹ `keygen`:
Ø§ÛŒÙ† ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ Ø§ÙˆÙ„ Ø­Ø¯Ø§Ù‚Ù„ Ø¨Ù‡ Ø·ÙˆÙ„ `nbit` Ù‡Ø³ØªØ´. Ø¨Ø®Ø§ÛŒÙ… ÛŒÚ©Ù… Ø¹Ù…ÛŒÙ‚ ØªØ± Ø¨Ù‡ ØªØ§Ø¨Ø¹ Ù†Ú¯Ø§Ù‡ÛŒ Ø¨Ù†Ø¯Ø§Ø²ÛŒÙ… Ù…ÛŒØ¨ÛŒÙ†ÛŒÙ… :

1. Ø¯Ø±ÙˆÙ† Ø­Ù„Ù‚Ù‡ `while True` Ù…ÛŒØ§Ø¯ ÛŒÚ© Ø¹Ø¯Ø¯ `18` Ø¨ÛŒØªÛŒ Ù…ÛŒØ³Ø§Ø²Ù‡ (`r`)
2. Ø¨Ù‡ ØªØ§Ø¨Ø¹ `check` Ù¾Ø§Ø³Ø´ Ù…ÛŒØ¯Ù‡.
3. Ø¯Ø± ØµÙˆØ±ØªÛŒ Ú©Ù‡ Ù„ÛŒØ³Øª Ø®Ø±ÙˆØ¬ÛŒØ´ Ø®Ø§Ù„ÛŒ Ù†Ø¨Ø§Ø´Ù‡ØŒ Ù…ÛŒØ§Ø¯ Ø³ÙˆØ±ØªØ´ Ù…ÛŒÚ©Ù†Ù‡ Ùˆ Ø§Ø®Ø±ÛŒÙ† Ø¢ÛŒØªÙ… Ù„ÛŒØ³Øª Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒÚ©Ù†Ù‡ Ùˆ ØªÙˆ Ù…ØªØºÛŒØ± `p` Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒÚ©Ù†Ù‡ (Ø¨Ù‡ Ù†ÙˆØ¹ÛŒ Ø¯Ø§Ø±Ù‡ Ø¨Ø²Ø±Ú¯ØªØ±ÛŒÙ† Ø¹Ø¯Ø¯ Ø§ÙˆÙ„ Ù„ÛŒØ³Øª Ø®Ø±ÙˆØ¬ÛŒ Ø±Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒÚ©Ù†Ù‡)
4. Ø³Ù¾Ø³ Ø¯Ø± ØµÙˆØ±ØªÛŒÚ©Ù‡ Ø¹Ø¯Ø¯ Ø§ÙˆÙ„ Ø¬Ø¯Ø§ Ø´Ø¯Ù‡ Ø·ÙˆÙ„Ø´ Ø­Ø¯Ø§Ù‚Ù„ `nbit` Ø¨Ø§Ø´Ù‡ Ø¨Ø±Ø§Ù…ÙˆÙ† Ø¨Ø±Ù…ÛŒÚ¯Ø±Ø¯ÙˆÙ†Ù‡ ÙˆÚ¯Ø±Ù†Ù‡ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§ÛŒÙ† Ø±ÙˆÙ†Ø¯ ØªÚ©Ø±Ø§Ø± Ù…ÛŒØ´Ù‡

```python
def keygen(nbit):
    while True:
        r = getRandomNBitInteger(18)
        if len(check(r)) != 0:
            cr = check(r)
            cr.sort()
            p = cr[-1]
            if p.bit_length() >= nbit:
                return r, p
```


## Ø±ÙˆØ´ Ø­Ù„


Ø¯Ø± Ø§ÛŒÙ† Ø³ÙˆØ§Ù„ Ø§Ø² ÛŒÚ© Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… ØºÛŒØ±Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ (ØªØ§Ø¨Ø¹ keygen) Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¹Ø¯Ø¯ Ø§ÙˆÙ„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¨ÙˆØ¯. Ø¯Ø±Ø³ØªÙ‡ Ø§Ø¹Ø¯Ø§Ø¯ Ø§ÙˆÙ„ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ 256 Ø¨ÛŒØªÛŒ Ù‡Ø³ØªÙ†Ø¯ØŒ ÙˆÙ„ÛŒ Ø§Ø² Ø¹Ø¯Ø¯ 18 Ø¨ÛŒØªÛŒ r Ù…Ø´ØªÙ‚ Ø´Ø¯Ù‡ Ø§Ù†Ø¯. Ø¯Ø± Ù†ØªÛŒØ¬Ù‡ Ø§Ú¯Ù‡ Ø¨ÛŒØ§ÛŒÙ… Ø±ÙˆÛŒ Ù…ØªØºÛŒØ± r ÛŒÚ© Ø¨Ø±ÙˆØª ÙÙˆØ±Ø³ Ø§Ù†Ø¬Ø§Ù… Ø¨Ø¯ÛŒÙ…ØŒ Ù…ÛŒØªÙˆÙ†ÛŒÙ… ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ÛŒ n Ø±Ùˆ Ø¨Ø¯Ø³Øª Ø¨ÛŒØ§Ø±ÛŒÙ… Ùˆ ÙÙ„Ú¯ Ø±Ù…Ø² Ø´Ø¯Ù‡ Ø±Ùˆ Ø±Ù…Ø²Ú¯Ø´Ø§ÛŒÛŒ Ú©Ù†ÛŒÙ…ðŸ˜ðŸ˜Ž

```python
def check(n):
    sn = str(n)
    l, P = len(str(n)), []
    for i in range(1, l - 1):
        for j in range(i + 1, l):
            g, e, a = int(sn[:i]), int(sn[i:j]), int(sn[j:])
            if isPrime(g ** e + a):
                P.append(g ** e + a)
            if isPrime(g** e - a):
                P.append(g ** e - a)
    return P

for i in range(1, 2**17):
    r = 2**17 + i
    if len((cr:=check(r))) != 0:
        cr.sort()
        p = cr[-1]
        if p.bit_length() >= 256:
            if n%p==0:
                break

# p = 259117086013202627776246767922441530941818887553125427303974923161874019266586362086201209516800483406550695241733194177441689509238807017410377709597512042313066624082916353517952311186154862265604547691127595848775610568757931191017711408826252153849035830401185072116424747461823031471398340229288074545677907941037288235820705892351068433882986888616658650280927692080339605869308790500409503709875902119018371991620994002568935113136548829739112656797303241986517250116412703509705427773477972349821676443446668383119322540099648994051790241624056519054483690809616061625743042361721863339415852426431208737266591962061753535748892894599629195183082621860853400937932839420261866586142503251450773096274235376822938649407127700846077124211823080804139298087057504713825264571448379371125032081826126566649084251699453951887789613650248405739378594599444335231188280123660406262468609212150349937584782292237144339628858485938215738821232393687046160677362909315071
q = n//p
e = 0x10001
phi=(p-1)*(q-1)
d=pow(e,-1,phi)
print(long_to_bytes(pow(enc,d,n)))
```


---
??? success "FLAG :triangular_flag_on_post:"
    <div dir="ltr">`SNAPP{B0m84S7!C_Pr1m3_9EneR4T!0N!!!}`</div>


!!! Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡
    [mheidari98](https://github.com/mheidari98)

