---
tags:
  - SnappCTF
  - SnappCTF-2023
  - Crypto
  - AES-ECB
  - ECB mode
---

تو این چلنج یه فایل بش داریم که به ما میفهمونه انکریپشن استفاده شده تایپ ECB هست و این تایپ از انکریپشن AES یه باگ (که البته فیچر هم هست :joy:) که باید از این باگ سوء استفاده کنیم تا بتونیم فلگ رو بخونیم

معروف ترین عکس در رابطه با این باگ این عکسه

![[PeNgUiN!]](mascot-1.png)

فرمت ppm به صورتی هست که 3 خط اول به عنوان هدر تعریف میشن
ما با خط دوم کار داریم که رزولوشن هست :smiling_imp:

یه اسکریپت پایتون مینویسیم که بیاد رزولوشن رو بروت فورس کنیم

تو یه رایتاپ دیگه تو همین بلاگ اشاره کردم که:
> پیکسل های تصاویر از چپ به راست تکمیل میشن و ارتفاع تاثیری در پیکسل ها و ترتیبشون نداره

پس ما فقط پارامتر x رو تغییر بدیم =)))

اسکریپت بدین صورت است

```python linenums="1"
b = open("flag.enc", "rb").read()

base = """P6
{} {}
65535
"""
y = 100
for x in range(1000):
    with open("res/{}x{}.png".format(x,y), 'wb') as f:
        f.write(base.format(x,y).encode() + b)
```

بعد از اجرای اسکریپت، فلگ در رزولوشن 740x100.png مشاهده میشود

![Mascot](mascot-2.png)
---
!!! نویسنده
    [SafaSafari](https://twitter.com/SafaSafari3)$~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~$تاریخ نگارش ۱۴۰۲/۱۲/۴