---
tags:
  - Crypto
  - Diffie Hellman
  - Diffie Hellman Key Exchange
  - Modular arithmetic
---

## تبادل کلید دیفی-هلمن

تبادل کلید **دیفی-هلمن (Diffie-Hellman Key Exchange)** یک روش رمزنگاری است که به دو طرف اجازه می‌دهد تا یک کلید مشترک را از طریق یک کانال ناامن به اشتراک بگذارند. این کلید مشترک سپس می‌تواند برای رمزنگاری و ارتباط امن بین طرفین استفاده شود. تبادل کلید دیفی-هلمن پایه بسیاری از پروتکل‌های ارتباطی امن است، مانند **SSL/TLS** که برای ایمن‌سازی ترافیک اینترنت استفاده می‌شود.


### مفاهیم کلیدی

- **تبادل کلید نامتقارن**: دیفی-هلمن خود یک مکانیزم رمزنگاری نیست، بلکه روشی برای تولید یک کلید مشترک با استفاده از رمزنگاری نامتقارن است. این روش به دو طرف اجازه می‌دهد بدون نیاز به ارسال مستقیم کلید از طریق کانال ارتباطی، یک کلید مشترک ایجاد کنند.

- **پارامترهای عمومی**:
    - یک **عدد اول** \( p \) و یک **پایه (یا مولد)** \( g \) انتخاب می‌شوند. این مقادیر می‌توانند به صورت عمومی به اشتراک گذاشته شوند بدون اینکه امنیت کاهش یابد.

- **فرایند تبادل کلید**:
    - **مرحله ۱**: هر طرف یک کلید خصوصی تولید می‌کند. فرض کنیم کلید خصوصی آلیس \( a \) و کلید خصوصی باب \( b \) باشد.
    - **مرحله ۲**: آلیس کلید عمومی خود را به صورت \( A = g^a \pmod{p} \) محاسبه می‌کند و باب نیز کلید عمومی خود را به صورت \( B = g^b \pmod{p} \) محاسبه می‌کند.
    - **مرحله ۳**: آلیس کلید عمومی \( A \) را به باب ارسال می‌کند و باب نیز کلید عمومی \( B \) را به آلیس می‌فرستد.
    - **مرحله ۴**: هر دو طرف کلید مشترک را با توان‌دهی به کلید عمومی طرف دیگر محاسبه می‌کنند:
        - آلیس کلید مشترک را به صورت \( s = B^a \pmod{p} \) محاسبه می‌کند.
        - باب کلید مشترک را به صورت \( s = A^b \pmod{p} \) محاسبه می‌کند.

    از آنجا که \( s = (g^b)^a \pmod{p} = (g^a)^b \pmod{p} \)، هر دو طرف اکنون یک مقدار مشترک \( s \) دارند که می‌تواند به عنوان کلید برای رمزنگاری متقارن استفاده شود.

### مثال

فرض کنیم \( p = 23 \) (یک عدد اول) و \( g = 5 \):

- **مرحله ۱**: آلیس \( a = 6 \) (کلید خصوصی) و باب \( b = 15 \) (کلید خصوصی) را انتخاب می‌کنند.
- **مرحله ۲**: آلیس \( A = 5^6 \pmod{23} = 8 \) را محاسبه می‌کند و باب \( B = 5^{15} \pmod{23} = 19 \) را محاسبه می‌کند.
- **مرحله ۳**: آلیس و باب کلیدهای عمومی خود را مبادله می‌کنند: \( A = 8 \) و \( B = 19 \).
- **مرحله ۴**: آلیس \( s = 19^6 \pmod{23} = 2 \) و باب \( s = 8^{15} \pmod{23} = 2 \) را محاسبه می‌کنند.

اکنون آلیس و باب هر دو یک کلید مشترک \( s = 2 \) دارند.

### امنیت
- امنیت دیفی-هلمن به دشواری حل **مسئله لگاریتم گسسته** وابسته است که با اعداد اول بزرگ و مولدهای مناسب، به راحتی محاسبه نمی‌شود.
- این روش در برابر حملات **man-in-middle** آسیب‌پذیر است، مگر اینکه مکانیزم‌های احراز هویت در کنار آن استفاده شوند.

--- 

!!! نویسنده
    [تیم فلگ موتوری](https://github.com/flagmotori)